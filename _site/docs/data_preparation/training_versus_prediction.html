<!DOCTYPE html>
<!-- Huge thanks to: http://stackoverflow.com/a/16389663/2540303 -->
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="http://robertzk.github.io/r-book/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="http://robertzk.github.io/r-book/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="http://robertzk.github.io/r-book/stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript">
      $(function () {
          $('a').each(function () {
              var ext = '.md';
              var href = $(this).attr('href');
              var position = href.length - ext.length;
              if (href.substring(position) === ext)
                  $(this).attr('href', href.substring(0, position) + '.html');
          });
      });
    </script>

    <title>R-book by robertzk</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>R-book</h1>
        <h2>Classifier Development in R</h2>
        <a href="https://github.com/robertzk/r-book" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

        <p><strong><a href="index.html">Previous Section</a></strong> | <strong><a href="../index.html">Index</a></strong> | <strong><a href="training_versus_prediction.html">Next Section</a></strong></p>

<h1>Training versus prediction</h1>

<p>The difference between preparing data for a one-time statistics project and for real-time usage
has one important pitfall: our code may not always look the same for training as for prediction.</p>

<p>For example, consider mean imputation--taking a variable, i.e., a column of data in a <code>data.frame</code>, and
replacing missing values with the mean.</p>
<div class="highlight"><pre><code class="r language-r" data-lang="r">example_data <span class="o">&lt;-</span>
  data.frame<span class="p">(</span>one <span class="o">=</span> c<span class="p">(</span>rnorm<span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="kc">NA</span><span class="p">),</span>
             two <span class="o">=</span> c<span class="p">(</span><span class="kc">NA</span><span class="p">,</span> rnorm<span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">5</span><span class="p">)))</span>
<span class="c1"># example_data is now a data.frame with two columns, the first 100 values drawn from</span>
<span class="c1"># a normal distribution with mean 0 and standard deviation 1 followed by a missing value,</span>
<span class="c1"># and the latter column a missing value followed by a normal distribution with mean 10</span>
<span class="c1"># and standard deviation 5.</span>
print<span class="p">(</span>rbind<span class="p">(</span>head<span class="p">(</span>example_data<span class="p">,</span> <span class="m">2</span><span class="p">),</span> tail<span class="p">(</span>example_data<span class="p">,</span> <span class="m">2</span><span class="p">)))</span>
</code></pre></div><div class="highlight"><pre><code class="text language-text" data-lang="text">##         one    two
## 1   -0.5622     NA
## 2   -0.4801  7.702
## 100  0.2023 16.692
## 101      NA  9.899
</code></pre></div><div class="highlight"><pre><code class="r language-r" data-lang="r"><span class="kr">for</span> <span class="p">(</span>col <span class="kr">in</span> seq_along<span class="p">(</span>example_data<span class="p">))</span> <span class="c1"># Now impute each column with its mean</span>
  example_data<span class="p">[</span>is.na<span class="p">(</span>example_data<span class="p">[[</span>col<span class="p">]]),</span> col<span class="p">]</span> <span class="o">&lt;-</span> mean<span class="p">(</span>example_data<span class="p">[[</span>col<span class="p">]],</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
print<span class="p">(</span>rbind<span class="p">(</span>head<span class="p">(</span>example_data<span class="p">,</span> <span class="m">2</span><span class="p">),</span> tail<span class="p">(</span>example_data<span class="p">,</span> <span class="m">2</span><span class="p">)))</span>
</code></pre></div><div class="highlight"><pre><code class="text language-text" data-lang="text">##         one    two
## 1   -0.5622 10.094
## 2   -0.4801  7.702
## 100  0.2023 16.692
## 101 -0.2242  9.899
</code></pre></div>
<p>However, when we are predicting on single data points in real-time, our <code>data.frame</code>s will be
only one row: imputing will make no sense. We must <em>remember</em> the mean that we 
used during training. The implication is that future data points are assumed to come
from the same distribution as the training data points, so their expected value is
the mean of the distribution, which is best approximated by the mean of our training sample.</p>

<p>We have now come to our first fork in the road. We can choose two paths: we can decide that whenever we have to perform some pre-processing operations on portions of a dataset, we resolve to also write any necessary prediction function. We will use the former code for training, and the latter code for prediction, and will keep the two
in separate places.</p>

<p>The other option is to force ourselves to develop a convention that will make it impossible to forget
about the distinction between pre-processing for training and pre-processing for prediction, and allow
us to use the same code to perform either step.</p>

<p>The rest of this chapter is dedicated to one example of such a convention--the <strong>mungebits</strong> package 
that comes with the syberia collection of packages.</p>

<p><strong><a href="index.html">Previous Section</a></strong> | <strong><a href="../index.html">Index</a></strong> | <strong><a href="training_versus_prediction.html">Next Section</a></strong></p>


        </section>

        <aside id="sidebar" style="display:none">
          <a href="https://github.com/robertzk/r-book/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/robertzk/r-book/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/robertzk/r-book"></a> is maintained by <a href="https://github.com/robertzk">robertzk</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
